import{_ as F}from"./BJaxSbV9.js";import{_ as T}from"./2RxMe3I3.js";import{_ as G}from"./DaXXJcGT.js";import{i as J,j as K,I as Q,H as W,k as X,e as Y,c,a as o,m as h,p as v,w as y,d as S,t as r,h as e,b as l,q as k,F as M,s as z,z as b,l as Z,o as n,x as j}from"./JU7iOayy.js";import{u as ee}from"./CXkG_b36.js";import{A as te}from"./DVsceWOn.js";import{D as A}from"./BpmzpYBX.js";import{c as B}from"./Dn2euNds.js";import{M as oe,L as se}from"./CAZMs8OK.js";import{P as ne}from"./CbHm8mcU.js";import"./GJI3iByT.js";const re=B("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const ae=B("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),ie={class:"min-h-dvh bg-background"},ce={class:"sticky top-0 z-10 bg-card/80 backdrop-blur-lg border-b border-border"},le={class:"flex items-center gap-4 px-4 py-4"},de={class:"heading flex-1 font-display text-lg font-bold tracking-tight truncate",initial:{opacity:0,y:-10},enter:{opacity:1,y:0,transition:{delay:100}}},ue={key:0,class:"p-4 space-y-6"},me={class:"font-display text-xl font-bold mb-1"},pe={class:"text-primary-foreground/80 mb-4"},fe={initial:{opacity:0,y:20},enter:{opacity:1,y:0,transition:{delay:200}}},_e={class:"text-xs font-semibold uppercase tracking-wider text-muted-foreground mb-3"},he={class:"space-y-2"},ye=["enter"],ge={class:"rank font-display text-lg font-bold text-muted-foreground w-8 text-center"},xe={class:"name flex-1 font-medium text-foreground"},be={class:"score font-display text-xl font-bold text-accent"},ve={initial:{opacity:0,y:20},enter:{opacity:1,y:0,transition:{delay:350}}},ke={class:"text-xs font-semibold uppercase tracking-wider text-muted-foreground mb-3"},we={class:"space-y-2"},Ce={class:"player-name flex-1 font-medium text-foreground"},Re={class:"score-controls flex items-center gap-1"},Se=["disabled","onClick"],je=["value","disabled","onChange"],Le=["disabled","onClick"],Me={class:"player-total font-display text-base font-semibold text-primary min-w-12 text-right"},ze={key:1,class:"flex gap-3",initial:{opacity:0,y:20},enter:{opacity:1,y:0,transition:{delay:400}}},Ae={key:1,class:"flex items-center justify-center min-h-[50vh]"},Be={class:"text-muted-foreground"},Te=J({__name:"[id]",setup(De){const{t:f}=K(),D=Q(),N=W(),{getSession:U,updatePlayerScore:w,addRound:H,closeSession:I,sessions:O}=ee(),g=b(()=>D.params.id),t=b(()=>U(g.value)),C=b(()=>t.value?[...t.value.players].sort((s,p)=>p.total-s.total):[]),m=b(()=>t.value?t.value.isClosed||t.value.maxRounds&&t.value.currentRound>t.value.maxRounds?!0:t.value.maxScore?t.value.players.some(s=>s.total>=t.value.maxScore):!1:!1),P=b(()=>t.value?!m.value&&t.value.players.some(s=>s.total!==0):!1);function V(){I(g.value)}function q(s,p,x){const d=x.target,u=parseInt(d.value)||0;w(g.value,s,p,u)}function $(){H(g.value)}function R(s,p){return t.value?.players.find(d=>d.id===s)?.scores[p-1]??0}function E(s){return s===0?"ring-2 ring-yellow-500/50 bg-gradient-to-br from-card to-yellow-500/10":s===1?"ring-1 ring-gray-400/30 bg-gradient-to-br from-card to-gray-400/5":s===2?"ring-1 ring-orange-600/30 bg-gradient-to-br from-card to-orange-600/5":""}function L(){if(!t.value)return;const s={name:t.value.name,date:t.value.createdAt,players:t.value.players.map(i=>({name:i.name,scores:i.scores,total:i.total})),rounds:t.value.currentRound,winner:C.value[0]?.name??null},p=JSON.stringify(s,null,2),x=new Blob([p],{type:"application/json"}),d=URL.createObjectURL(x),u=document.createElement("a");u.href=d,u.download=`${t.value.name.toLowerCase().replace(/\s+/g,"-")}-scores.json`,u.click(),URL.revokeObjectURL(d)}return X(O,()=>{},{deep:!0}),Y(()=>{t.value||N.push("/scores")}),(s,p)=>{const x=F,d=T,u=G,i=Z("motion");return n(),c("div",ie,[o("header",ce,[o("div",le,[h((n(),v(x,{to:"/scores",class:"session-page__back flex h-10 w-10 items-center justify-center rounded-full text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",initial:{opacity:0,x:-10},enter:{opacity:1,x:0}},{default:y(()=>[l(e(te),{class:"h-5 w-5"})]),_:1})),[[i]]),h((n(),c("h1",de,[S(r(e(t)?.name??""),1)])),[[i]]),e(t)?(n(),c("button",{key:0,class:"export-btn flex h-10 w-10 items-center justify-center rounded-full text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",onClick:L},[l(e(A),{class:"h-5 w-5"})])):k("",!0)])]),e(t)?(n(),c("div",ue,[e(m)?h((n(),v(u,{key:0,class:"game-over-banner p-6 bg-gradient-to-br from-primary to-primary/80 text-primary-foreground text-center",initial:{opacity:0,scale:.9},enter:{opacity:1,scale:1,transition:{delay:150}}},{default:y(()=>[l(e(ae),{class:"h-10 w-10 mx-auto mb-3"}),o("h2",me,r(e(f)("scores.session.gameOver")),1),o("p",pe,r(e(f)("scores.session.winner",{name:e(C)[0]?.name})),1),l(d,{variant:"secondary",class:"export-results-btn",onClick:L},{default:y(()=>[l(e(A),{class:"h-4 w-4 mr-2"}),S(" "+r(e(f)("scores.session.export")),1)]),_:1})]),_:1})),[[i]]):k("",!0),h((n(),c("section",fe,[o("h2",_e,r(e(f)("scores.session.leaderboard")),1),o("ul",he,[(n(!0),c(M,null,z(e(C),(a,_)=>h((n(),c("li",{key:a.id,initial:{opacity:0,x:-20},enter:{opacity:1,x:0,transition:{delay:250+_*50}}},[l(u,{class:j(["leaderboard-item flex items-center gap-3 p-3",E(_)])},{default:y(()=>[o("span",ge,r(_+1),1),o("span",xe,r(a.name),1),o("span",be,r(a.total),1)]),_:2},1032,["class"])],8,ye)),[[i]])),128))])])),[[i]]),h((n(),c("section",ve,[o("h2",ke,r(e(f)("scores.round"))+" "+r(e(t).currentRound),1),o("div",we,[(n(!0),c(M,null,z(e(t).players,a=>(n(),v(u,{key:a.id,class:"score-row flex items-center gap-3 p-3"},{default:y(()=>[o("span",Ce,r(a.name),1),o("div",Re,[o("button",{class:j(["score-btn w-9 h-9 rounded-lg bg-muted text-foreground flex items-center justify-center transition-colors",e(m)?"opacity-50 cursor-not-allowed":"hover:bg-muted/80 active:bg-primary active:text-primary-foreground"]),disabled:e(m),onClick:_=>e(w)(e(g),a.id,e(t).currentRound,R(a.id,e(t).currentRound)-1)},[l(e(oe),{class:"h-4 w-4"})],10,Se),o("input",{type:"number",class:"score-input w-14 h-9 text-center rounded-lg border border-border bg-background text-foreground font-display font-medium focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",value:R(a.id,e(t).currentRound),disabled:e(m),onChange:_=>q(a.id,e(t).currentRound,_)},null,40,je),o("button",{class:j(["score-btn w-9 h-9 rounded-lg bg-muted text-foreground flex items-center justify-center transition-colors",e(m)?"opacity-50 cursor-not-allowed":"hover:bg-muted/80 active:bg-primary active:text-primary-foreground"]),disabled:e(m),onClick:_=>e(w)(e(g),a.id,e(t).currentRound,R(a.id,e(t).currentRound)+1)},[l(e(ne),{class:"h-4 w-4"})],10,Le)]),o("span",Me,r(a.total),1)]),_:2},1024))),128))])])),[[i]]),e(m)?k("",!0):h((n(),c("div",ze,[l(d,{class:"next-round-btn flex-1",size:"lg",onClick:$},{default:y(()=>[S(r(e(f)("scores.session.nextRound"))+" ",1),l(e(re),{class:"h-5 w-5 ml-1"})]),_:1}),e(P)?(n(),v(d,{key:0,class:"close-session-btn",size:"lg",variant:"secondary",onClick:V},{default:y(()=>[l(e(se),{class:"h-5 w-5"})]),_:1})):k("",!0)])),[[i]])])):(n(),c("div",Ae,[o("p",Be,r(e(f)("common.loading")),1)]))])}}});export{Te as default};
