import{_ as we}from"./CJ4cJp4b.js";import{_ as ge}from"./BnUVIDLX.js";import{_ as ke,X as Pe}from"./B57y80sn.js";import{_ as Se,P as re}from"./dR07OhUR.js";import{_ as Ce}from"./BGXJZgrc.js";import{_ as Ve}from"./Cr7CcaXS.js";import{A as Be,z as O,r as P,i as Le,j as Ue,c as x,a as t,b as a,w as c,t as l,h as e,q as k,x as Ae,p as g,F as L,s as A,l as Fe,o as m,d as p,m as F,E as I,G as Oe,C as ze}from"./85CuR8qa.js";import{A as $e}from"./8KN2TOyx.js";import{D as Ge}from"./CjPr12uJ.js";import{c as z}from"./sFs-GXhc.js";import{U as He}from"./CGGRJAjd.js";import{P as De}from"./CqiwjnuP.js";import{T as je}from"./BpZlIGRI.js";import{H as Ie}from"./bryQlBeW.js";import"./DKh0UTUP.js";const Me=z("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const Ne=z("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const ne=z("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const Ee=z("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);const Te=z("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),ae="gamepal-library",v=P([]),ie=P(!1);function de(){return Math.random().toString(36).substring(2,9)}function Re(){function X(){if(!ie.value){if(typeof window<"u"){const n=localStorage.getItem(ae);if(n)try{v.value=JSON.parse(n)}catch{v.value=[]}}ie.value=!0}}function s(){typeof window<"u"&&localStorage.setItem(ae,JSON.stringify(v.value))}function M(n){const i={id:de(),createdAt:new Date().toISOString(),loanHistory:[],...n};return v.value.push(i),s(),i}function S(n,i){const u=v.value.find(_=>_.id===n);u&&(Object.assign(u,i),s())}function N(n){const i=v.value.findIndex(u=>u.id===n);i!==-1&&(v.value.splice(i,1),s())}function E(n){return v.value.find(i=>i.id===n)??null}function T(n,i){const u=v.value.find(_=>_.id===n);if(u){if(u.loanHistory||(u.loanHistory=[]),i!==null){const _={id:de(),borrower:i,lentAt:new Date().toISOString(),returnedAt:null};u.loanHistory.push(_),u.isBorrowed=!0,u.borrowedTo=i}else{const _=u.loanHistory.find(C=>C.returnedAt===null);_&&(_.returnedAt=new Date().toISOString()),u.isBorrowed=!1,u.borrowedTo=null}s()}}function $(n){return v.value.find(u=>u.id===n)?.loanHistory??[]}function R(n,i){const u=v.value.find(_=>_.id===n);u&&(u.forSale=i,s())}function q(n){return v.value.filter(i=>{if(n.search){const u=n.search.toLowerCase();if(!i.name.toLowerCase().includes(u))return!1}return!(n.style&&i.style!==n.style||n.mood&&i.mood!==n.mood||n.minPlayers&&i.maxPlayers<n.minPlayers||n.maxPlayers&&i.minPlayers>n.maxPlayers||!n.showOwned&&i.isOwned&&!i.isBorrowed&&!i.forSale||!n.showBorrowed&&i.isBorrowed||!n.showForSale&&i.forSale)})}const K=O(()=>{const n=v.value.length,i=v.value.filter(d=>d.isOwned).length,u=v.value.filter(d=>d.isBorrowed).length,_=v.value.filter(d=>d.forSale).length,C=v.value.map(d=>d.minPlayers),V=v.value.map(d=>d.maxPlayers),U=v.value.reduce((d,f)=>d+(f.loanHistory?.length??0),0);return{total:n,owned:i,borrowed:u,forSale:_,minPlayers:C.length>0?Math.min(...C):0,maxPlayers:V.length>0?Math.max(...V):0,totalLoans:U}}),G=O(()=>{const n=new Set;for(const i of v.value)i.style&&n.add(i.style);return Array.from(n).sort()}),H=O(()=>{const n=new Set;for(const i of v.value)i.mood&&n.add(i.mood);return Array.from(n).sort()});function D(){return JSON.stringify(v.value,null,2)}return X(),{games:Be(v),stats:K,styles:G,moods:H,addGame:M,updateGame:S,deleteGame:N,getGame:E,markAsBorrowed:T,markForSale:R,filterGames:q,exportLibrary:D,getLoanHistory:$}}const qe={class:"min-h-dvh bg-background"},Ke={class:"sticky top-0 z-10 bg-card/80 backdrop-blur-lg border-b border-border"},Je={class:"flex items-center gap-4 px-4 py-4"},Ye={class:"heading flex-1 font-display text-lg font-bold tracking-tight"},Xe={class:"p-4 space-y-4"},Qe={key:0,class:"space-y-2"},We={class:"grid grid-cols-4 gap-2"},Ze={class:"text-2xl font-bold text-primary"},et={class:"text-xs text-muted-foreground block"},tt={class:"text-2xl font-bold text-green-500"},ot={class:"text-xs text-muted-foreground block"},lt={class:"text-2xl font-bold text-orange-500"},st={class:"text-xs text-muted-foreground block"},rt={class:"text-2xl font-bold text-blue-500"},nt={class:"text-xs text-muted-foreground block"},at={class:"grid grid-cols-2 gap-2"},it={class:"text-lg font-bold text-muted-foreground"},dt={class:"text-xs text-muted-foreground block"},ut={class:"text-lg font-bold text-muted-foreground"},ct={class:"text-xs text-muted-foreground block"},mt={class:"flex gap-2"},ft={class:"relative flex-1"},yt={class:"flex items-center justify-between"},vt={class:"font-semibold"},pt={class:"grid grid-cols-2 gap-3"},bt={class:"text-xs text-muted-foreground block mb-1"},_t={value:null},xt=["value"],ht={class:"text-xs text-muted-foreground block mb-1"},wt={value:null},gt=["value"],kt={class:"grid grid-cols-2 gap-3"},Pt={class:"text-xs text-muted-foreground block mb-1"},St={class:"text-xs text-muted-foreground block mb-1"},Ct={class:"flex flex-wrap gap-2"},Vt={class:"flex items-center justify-between"},Bt={class:"font-semibold"},Lt={class:"grid grid-cols-2 gap-3"},Ut={class:"text-xs text-muted-foreground block mb-1"},At={class:"text-xs text-muted-foreground block mb-1"},Ft={class:"grid grid-cols-2 gap-3"},Ot={class:"text-xs text-muted-foreground block mb-1"},zt=["value"],$t={class:"text-xs text-muted-foreground block mb-1"},Gt=["value"],Ht={key:3,class:"game-list space-y-2"},Dt={class:"flex items-start gap-3"},jt={class:"flex-1"},It={class:"font-semibold text-foreground"},Mt={class:"flex items-center gap-2 mt-1 text-sm text-muted-foreground"},Nt={key:0,class:"px-2 py-0.5 bg-muted rounded text-xs"},Et={class:"flex flex-wrap gap-1 mt-2"},Tt={class:"flex gap-1"},Rt={class:"flex flex-wrap gap-2 mt-3 pt-3 border-t border-border"},qt={key:0,class:"mt-3 pt-3 border-t border-border"},Kt={class:"text-sm font-medium mb-2"},Jt={class:"space-y-2"},Yt={class:"font-medium"},Xt={class:"text-muted-foreground"},Qt={key:1,class:"flex gap-2 mt-3 pt-3 border-t border-border"},Wt={key:2,class:"flex items-center gap-2 mt-3 pt-3 border-t border-border"},Zt={class:"flex-1 text-sm text-muted-foreground"},eo={key:4,class:"text-center py-12"},to={class:"text-muted-foreground mb-4"},oo={key:5,class:"text-center text-muted-foreground py-8"},xo=Le({__name:"library",setup(X){const{t:s}=Ue(),{games:M,stats:S,addGame:N,updateGame:E,deleteGame:T,markAsBorrowed:$,markForSale:R,filterGames:q,exportLibrary:K,getLoanHistory:G}=Re(),H=["strategy","party","family","cooperative","card","dice","rpg","trivia"],D=["casual","competitive","relaxed","intense","funny","serious"],n=P(!1),i=P(!1),u=P(null),_=P(null),C=P(null),V=P(""),U=P(null),d=P({search:"",style:null,mood:null,minPlayers:null,maxPlayers:null,showOwned:!0,showBorrowed:!0,showForSale:!0}),f=P({name:"",minPlayers:2,maxPlayers:4,style:null,mood:null}),Q=O(()=>q(d.value)),W=O(()=>d.value.style!==null||d.value.mood!==null||d.value.minPlayers!==null||d.value.maxPlayers!==null||!d.value.showOwned||!d.value.showBorrowed||!d.value.showForSale);function ue(){f.value.name.trim()!==""&&(N({name:f.value.name.trim(),minPlayers:f.value.minPlayers,maxPlayers:f.value.maxPlayers,style:f.value.style,mood:f.value.mood,isOwned:!0,isBorrowed:!1,borrowedTo:null,forSale:!1}),Z(),n.value=!1)}function Z(){f.value={name:"",minPlayers:2,maxPlayers:4,style:null,mood:null}}function ce(y){u.value=y.id,f.value={name:y.name,minPlayers:y.minPlayers,maxPlayers:y.maxPlayers,style:y.style,mood:y.mood},n.value=!0}function me(){u.value&&f.value.name.trim()&&E(u.value,{name:f.value.name.trim(),minPlayers:f.value.minPlayers,maxPlayers:f.value.maxPlayers,style:f.value.style,mood:f.value.mood}),ee()}function ee(){u.value=null,Z(),n.value=!1}function fe(y){T(y),_.value=null}function te(y){V.value.trim()&&$(y,V.value.trim()),C.value=null,V.value=""}function ye(y){$(y,null)}function ve(y){R(y.id,!y.forSale)}function pe(){d.value={search:"",style:null,mood:null,minPlayers:null,maxPlayers:null,showOwned:!0,showBorrowed:!0,showForSale:!0}}function be(){const y=K(),r=new Blob([y],{type:"application/json"}),j=URL.createObjectURL(r),w=document.createElement("a");w.href=j,w.download="gamepal-library.json",w.click(),URL.revokeObjectURL(j)}function J(y){return s(`library.styles.${y}`)}function oe(y){return s(`library.moods.${y}`)}function le(y){return new Date(y).toLocaleDateString()}function _e(y){U.value=U.value===y?null:y}return(y,r)=>{const j=we,w=ge,B=ke,h=Se,Y=Ce,se=Ve,xe=Fe("motion");return m(),x("div",qe,[t("header",Ke,[t("div",Je,[a(j,{to:"/",class:"library__back flex h-10 w-10 items-center justify-center rounded-full text-muted-foreground transition-colors hover:bg-muted hover:text-foreground"},{default:c(()=>[a(e($e),{class:"h-5 w-5"})]),_:1}),t("h1",Ye,l(e(s)("library.title")),1),t("button",{class:"flex h-10 w-10 items-center justify-center rounded-full text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",onClick:be},[a(e(Ge),{class:"h-5 w-5"})])])]),t("div",Xe,[e(S).total>0?(m(),x("div",Qe,[t("div",We,[a(w,{class:"stat-card p-3 text-center"},{default:c(()=>[t("span",Ze,l(e(S).total),1),t("span",et,l(e(s)("library.stats.total")),1)]),_:1}),a(w,{class:"stat-card p-3 text-center"},{default:c(()=>[t("span",tt,l(e(S).owned),1),t("span",ot,l(e(s)("library.stats.owned")),1)]),_:1}),a(w,{class:"stat-card p-3 text-center"},{default:c(()=>[t("span",lt,l(e(S).borrowed),1),t("span",st,l(e(s)("library.stats.borrowed")),1)]),_:1}),a(w,{class:"stat-card p-3 text-center"},{default:c(()=>[t("span",rt,l(e(S).forSale),1),t("span",nt,l(e(s)("library.stats.forSale")),1)]),_:1})]),t("div",at,[a(w,{class:"stat-card p-3 text-center"},{default:c(()=>[t("span",it,l(e(S).minPlayers)+"-"+l(e(S).maxPlayers),1),t("span",dt,l(e(s)("library.stats.playerRange")),1)]),_:1}),a(w,{class:"stat-card p-3 text-center"},{default:c(()=>[t("span",ut,l(e(S).totalLoans),1),t("span",ct,l(e(s)("library.stats.totalLoans")),1)]),_:1})])])):k("",!0),t("div",mt,[t("div",ft,[a(e(Te),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a(B,{modelValue:e(d).search,"onUpdate:modelValue":r[0]||(r[0]=o=>e(d).search=o),placeholder:e(s)("library.search"),class:"pl-10"},null,8,["modelValue","placeholder"])]),a(h,{variant:"outline",class:Ae({"bg-primary text-primary-foreground":e(i)||e(W)}),onClick:r[1]||(r[1]=o=>i.value=!e(i))},{default:c(()=>[a(e(Ee),{class:"h-4 w-4"})]),_:1},8,["class"]),a(h,{onClick:r[2]||(r[2]=o=>n.value=!0)},{default:c(()=>[a(e(re),{class:"h-4 w-4"})]),_:1})]),e(i)?(m(),g(w,{key:1,class:"filters p-4 space-y-4"},{default:c(()=>[t("div",yt,[t("h3",vt,l(e(s)("library.filters")),1),e(W)?(m(),g(h,{key:0,variant:"ghost",size:"sm",onClick:pe},{default:c(()=>[p(l(e(s)("library.clearFilters")),1)]),_:1})):k("",!0)]),t("div",pt,[t("div",null,[t("label",bt,l(e(s)("library.style")),1),F(t("select",{"onUpdate:modelValue":r[3]||(r[3]=o=>e(d).style=o),class:"w-full h-9 px-3 rounded-md border border-border bg-background text-sm"},[t("option",_t,l(e(s)("library.all")),1),(m(),x(L,null,A(H,o=>t("option",{key:o,value:o},l(J(o)),9,xt)),64))],512),[[I,e(d).style]])]),t("div",null,[t("label",ht,l(e(s)("library.mood")),1),F(t("select",{"onUpdate:modelValue":r[4]||(r[4]=o=>e(d).mood=o),class:"w-full h-9 px-3 rounded-md border border-border bg-background text-sm"},[t("option",wt,l(e(s)("library.all")),1),(m(),x(L,null,A(D,o=>t("option",{key:o,value:o},l(oe(o)),9,gt)),64))],512),[[I,e(d).mood]])])]),t("div",kt,[t("div",null,[t("label",Pt,l(e(s)("library.minPlayers")),1),a(B,{modelValue:e(d).minPlayers,"onUpdate:modelValue":r[5]||(r[5]=o=>e(d).minPlayers=o),modelModifiers:{number:!0},type:"number",min:"1",placeholder:"--"},null,8,["modelValue"])]),t("div",null,[t("label",St,l(e(s)("library.maxPlayers")),1),a(B,{modelValue:e(d).maxPlayers,"onUpdate:modelValue":r[6]||(r[6]=o=>e(d).maxPlayers=o),modelModifiers:{number:!0},type:"number",min:"1",placeholder:"--"},null,8,["modelValue"])])]),t("div",Ct,[a(h,{variant:e(d).showOwned?"default":"outline",size:"sm",onClick:r[7]||(r[7]=o=>e(d).showOwned=!e(d).showOwned)},{default:c(()=>[p(l(e(s)("library.owned")),1)]),_:1},8,["variant"]),a(h,{variant:e(d).showBorrowed?"default":"outline",size:"sm",onClick:r[8]||(r[8]=o=>e(d).showBorrowed=!e(d).showBorrowed)},{default:c(()=>[p(l(e(s)("library.borrowed")),1)]),_:1},8,["variant"]),a(h,{variant:e(d).showForSale?"default":"outline",size:"sm",onClick:r[9]||(r[9]=o=>e(d).showForSale=!e(d).showForSale)},{default:c(()=>[p(l(e(s)("library.forSale")),1)]),_:1},8,["variant"])])]),_:1})):k("",!0),e(n)?(m(),g(w,{key:2,class:"add-form p-4 space-y-4"},{default:c(()=>[t("div",Vt,[t("h3",Bt,l(e(u)?e(s)("library.editGame"):e(s)("library.addGame")),1),t("button",{class:"text-muted-foreground hover:text-foreground",onClick:ee},[a(e(Pe),{class:"h-5 w-5"})])]),a(B,{modelValue:e(f).name,"onUpdate:modelValue":r[10]||(r[10]=o=>e(f).name=o),placeholder:e(s)("library.gameName")},null,8,["modelValue","placeholder"]),t("div",Lt,[t("div",null,[t("label",Ut,l(e(s)("library.minPlayers")),1),a(B,{modelValue:e(f).minPlayers,"onUpdate:modelValue":r[11]||(r[11]=o=>e(f).minPlayers=o),modelModifiers:{number:!0},type:"number",min:"1"},null,8,["modelValue"])]),t("div",null,[t("label",At,l(e(s)("library.maxPlayers")),1),a(B,{modelValue:e(f).maxPlayers,"onUpdate:modelValue":r[12]||(r[12]=o=>e(f).maxPlayers=o),modelModifiers:{number:!0},type:"number",min:"1"},null,8,["modelValue"])])]),t("div",Ft,[t("div",null,[t("label",Ot,l(e(s)("library.style")),1),F(t("select",{"onUpdate:modelValue":r[13]||(r[13]=o=>e(f).style=o),class:"w-full h-9 px-3 rounded-md border border-border bg-background text-sm"},[r[20]||(r[20]=t("option",{value:null},"-",-1)),(m(),x(L,null,A(H,o=>t("option",{key:o,value:o},l(J(o)),9,zt)),64))],512),[[I,e(f).style]])]),t("div",null,[t("label",$t,l(e(s)("library.mood")),1),F(t("select",{"onUpdate:modelValue":r[14]||(r[14]=o=>e(f).mood=o),class:"w-full h-9 px-3 rounded-md border border-border bg-background text-sm"},[r[21]||(r[21]=t("option",{value:null},"-",-1)),(m(),x(L,null,A(D,o=>t("option",{key:o,value:o},l(oe(o)),9,Gt)),64))],512),[[I,e(f).mood]])])]),a(h,{class:"w-full",disabled:!e(f).name.trim(),onClick:r[15]||(r[15]=o=>e(u)?me():ue())},{default:c(()=>[p(l(e(u)?e(s)("common.save"):e(s)("common.add")),1)]),_:1},8,["disabled"])]),_:1})):k("",!0),e(Q).length>0?(m(),x("div",Ht,[(m(!0),x(L,null,A(e(Q),(o,he)=>F((m(),g(w,{key:o.id,initial:{opacity:0,y:10},enter:{opacity:1,y:0,transition:{delay:he*30}},class:"game-card p-4"},{default:c(()=>[t("div",Dt,[t("div",jt,[t("h3",It,l(o.name),1),t("div",Mt,[a(e(He),{class:"h-3 w-3"}),t("span",null,l(o.minPlayers)+"-"+l(o.maxPlayers),1),o.style?(m(),x("span",Nt,l(J(o.style)),1)):k("",!0)]),t("div",Et,[o.isBorrowed?(m(),g(Y,{key:0,variant:"warning"},{default:c(()=>[p(l(e(s)("library.lentTo",{name:o.borrowedTo})),1)]),_:2},1024)):k("",!0),o.forSale?(m(),g(Y,{key:1,variant:"secondary"},{default:c(()=>[a(e(ne),{class:"h-3 w-3 mr-1"}),p(" "+l(e(s)("library.forSale")),1)]),_:1})):k("",!0)])]),t("div",Tt,[a(se,{variant:"ghost",size:"sm",onClick:b=>ce(o)},{default:c(()=>[a(e(De),{class:"h-4 w-4"})]),_:1},8,["onClick"]),a(se,{variant:"destructive",size:"sm",onClick:b=>_.value=o.id},{default:c(()=>[a(e(je),{class:"h-4 w-4"})]),_:1},8,["onClick"])])]),t("div",Rt,[o.isBorrowed?(m(),g(h,{key:1,variant:"outline",size:"sm",onClick:b=>ye(o.id)},{default:c(()=>[p(l(e(s)("library.return")),1)]),_:1},8,["onClick"])):(m(),g(h,{key:0,variant:"outline",size:"sm",onClick:b=>C.value=o.id},{default:c(()=>[p(l(e(s)("library.lend")),1)]),_:1},8,["onClick"])),a(h,{variant:o.forSale?"default":"outline",size:"sm",onClick:b=>ve(o)},{default:c(()=>[a(e(ne),{class:"h-3 w-3 mr-1"}),p(" "+l(o.forSale?e(s)("library.notForSale"):e(s)("library.markForSale")),1)]),_:2},1032,["variant","onClick"]),e(G)(o.id).length>0?(m(),g(h,{key:2,variant:"ghost",size:"sm",onClick:b=>_e(o.id)},{default:c(()=>[a(e(Ie),{class:"h-3 w-3 mr-1"}),p(" "+l(e(s)("library.history"))+" ",1),e(U)===o.id?(m(),g(e(Ne),{key:0,class:"h-3 w-3 ml-1"})):(m(),g(e(Me),{key:1,class:"h-3 w-3 ml-1"}))]),_:2},1032,["onClick"])):k("",!0)]),e(U)===o.id?(m(),x("div",qt,[t("h4",Kt,l(e(s)("library.loanHistory")),1),t("div",Jt,[(m(!0),x(L,null,A(e(G)(o.id),b=>(m(),x("div",{key:b.id,class:"flex items-center justify-between text-sm p-2 bg-muted rounded"},[t("span",Yt,l(b.borrower),1),t("span",Xt,[p(l(le(b.lentAt))+" ",1),b.returnedAt?(m(),x(L,{key:0},[p(" â†’ "+l(le(b.returnedAt)),1)],64)):(m(),g(Y,{key:1,variant:"warning",class:"ml-2"},{default:c(()=>[p(l(e(s)("library.ongoing")),1)]),_:1}))])]))),128))])])):k("",!0),e(C)===o.id?(m(),x("div",Qt,[a(B,{modelValue:e(V),"onUpdate:modelValue":r[16]||(r[16]=b=>ze(V)?V.value=b:null),placeholder:e(s)("library.borrowerName"),class:"flex-1",onKeyup:Oe(b=>te(o.id),["enter"])},null,8,["modelValue","placeholder","onKeyup"]),a(h,{size:"sm",onClick:b=>te(o.id)},{default:c(()=>[p(l(e(s)("common.save")),1)]),_:1},8,["onClick"]),a(h,{variant:"ghost",size:"sm",onClick:r[17]||(r[17]=b=>C.value=null)},{default:c(()=>[p(l(e(s)("common.cancel")),1)]),_:1})])):k("",!0),e(_)===o.id?(m(),x("div",Wt,[t("span",Zt,l(e(s)("library.deleteConfirm",{name:o.name})),1),a(h,{size:"sm",variant:"destructive",onClick:b=>fe(o.id)},{default:c(()=>[p(l(e(s)("common.delete")),1)]),_:1},8,["onClick"]),a(h,{size:"sm",variant:"ghost",onClick:r[18]||(r[18]=b=>_.value=null)},{default:c(()=>[p(l(e(s)("common.cancel")),1)]),_:1})])):k("",!0)]),_:2},1032,["enter"])),[[xe]])),128))])):e(M).length===0?(m(),x("div",eo,[t("p",to,l(e(s)("library.empty")),1),a(h,{onClick:r[19]||(r[19]=o=>n.value=!0)},{default:c(()=>[a(e(re),{class:"h-4 w-4 mr-2"}),p(" "+l(e(s)("library.addFirst")),1)]),_:1})])):(m(),x("p",oo,l(e(s)("library.noResults")),1))])])}}});export{xo as default};
