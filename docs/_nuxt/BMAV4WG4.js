import{c as b}from"./Dn2euNds.js";import{A as G,z as i,r as m}from"./JU7iOayy.js";const k=b("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),d="gamepal-library",r=m([]),f=m(!1);function c(){return Math.random().toString(36).substring(2,9)}function D(){function y(){if(!f.value){if(typeof window<"u"){const e=localStorage.getItem(d);if(e)try{r.value=JSON.parse(e)}catch{r.value=[]}}f.value=!0}}function s(){typeof window<"u"&&localStorage.setItem(d,JSON.stringify(r.value))}function w(e){const n={id:c(),createdAt:new Date().toISOString(),loanHistory:[],...e};return r.value.push(n),s(),n}function v(e,n){const t=r.value.find(o=>o.id===e);t&&(Object.assign(t,n),s())}function S(e){const n=r.value.findIndex(t=>t.id===e);n!==-1&&(r.value.splice(n,1),s())}function g(e){return r.value.find(n=>n.id===e)??null}function h(e,n){const t=r.value.find(o=>o.id===e);if(t){if(t.loanHistory||(t.loanHistory=[]),n!==null){const o={id:c(),borrower:n,lentAt:new Date().toISOString(),returnedAt:null};t.loanHistory.push(o),t.isBorrowed=!0,t.borrowedTo=n}else{const o=t.loanHistory.find(l=>l.returnedAt===null);o&&(o.returnedAt=new Date().toISOString()),t.isBorrowed=!1,t.borrowedTo=null}s()}}function p(e){return r.value.find(t=>t.id===e)?.loanHistory??[]}function x(e,n){const t=r.value.find(o=>o.id===e);t&&(t.forSale=n,s())}function P(e){return r.value.filter(n=>{if(e.search){const t=e.search.toLowerCase();if(!n.name.toLowerCase().includes(t))return!1}return!(e.style&&n.style!==e.style||e.mood&&n.mood!==e.mood||e.minPlayers&&n.maxPlayers<e.minPlayers||e.maxPlayers&&n.minPlayers>e.maxPlayers||!e.showOwned&&n.isOwned&&!n.isBorrowed&&!n.forSale||!e.showBorrowed&&n.isBorrowed||!e.showForSale&&n.forSale)})}const O=i(()=>{const e=r.value.length,n=r.value.filter(a=>a.isOwned).length,t=r.value.filter(a=>a.isBorrowed).length,o=r.value.filter(a=>a.forSale).length,l=r.value.map(a=>a.minPlayers),u=r.value.map(a=>a.maxPlayers),L=r.value.reduce((a,B)=>a+(B.loanHistory?.length??0),0);return{total:e,owned:n,borrowed:t,forSale:o,minPlayers:l.length>0?Math.min(...l):0,maxPlayers:u.length>0?Math.max(...u):0,totalLoans:L}}),A=i(()=>{const e=new Set;for(const n of r.value)n.style&&e.add(n.style);return Array.from(e).sort()}),I=i(()=>{const e=new Set;for(const n of r.value)n.mood&&e.add(n.mood);return Array.from(e).sort()});function H(){return JSON.stringify(r.value,null,2)}return y(),{games:G(r),stats:O,styles:A,moods:I,addGame:w,updateGame:v,deleteGame:S,getGame:g,markAsBorrowed:h,markForSale:x,filterGames:P,exportLibrary:H,getLoanHistory:p}}export{k as S,D as u};
