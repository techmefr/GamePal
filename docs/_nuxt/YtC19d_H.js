import{_ as xe}from"./m4LV7nyU.js";import{_ as ye}from"./Cbd6NRa-.js";import{_ as ke,P as we}from"./BXj4j506.js";import{_ as Te,X as ce}from"./DOmmcJaj.js";import{f as Ce,A as ie,z as le,r as h,i as Pe,j as Se,k as Re,e as Le,c as f,a as i,b as u,w as k,t as p,h as t,F as B,s as E,x as T,B as ze,q as $,v as fe,m as me,C as ve,l as Ie,o as d,y as P,d as H,p as Ae,_ as Me}from"./_toqS5fQ.js";import{s as je}from"./B-6mWhxQ.js";import{A as Ne}from"./CjqhjfBM.js";import{c as re}from"./W6Z6A4iW.js";import{S as $e}from"./CR80q-Qr.js";import{D as Ue}from"./Dm84IkGY.js";import"./DNvWDFdm.js";const pe=re("hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);const Fe=re("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);const Ve=re("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),ge="gamepal-timer-presets",K=["#ef4444","#3b82f6","#22c55e","#f59e0b"],W=300,De=[{id:"builtin-1",name:"Speed (30s)",duration:30,game:null},{id:"builtin-2",name:"Blitz (1 min)",duration:60,game:null},{id:"builtin-3",name:"Standard (3 min)",duration:180,game:null},{id:"builtin-4",name:"Chess (5 min)",duration:300,game:"Chess"},{id:"builtin-5",name:"Chess (10 min)",duration:600,game:"Chess"},{id:"builtin-6",name:"Scrabble (2 min)",duration:120,game:"Scrabble"},{id:"builtin-7",name:"Taboo (1 min)",duration:60,game:"Taboo"},{id:"builtin-8",name:"Pictionary (1 min)",duration:60,game:"Pictionary"}];function he(){return Math.random().toString(36).substring(2,9)}function Oe(){const m=h([]),r=h(null),c=h(null),_=h([]),J=h(!1);function X(){if(!J.value){if(typeof window<"u"){const n=localStorage.getItem(ge);if(n)try{_.value=JSON.parse(n)}catch{_.value=[]}}J.value=!0}}function q(){typeof window<"u"&&localStorage.setItem(ge,JSON.stringify(_.value))}function S(n,s,a){const x={id:he(),label:n,duration:s,remaining:s,isRunning:!1,color:a};return m.value.push(x),x}function Y(n=W){R(),S("Timer",n,K[0])}function Z(n=W){R(),S("Player 1",n,K[0]),S("Player 2",n,K[1])}function Q(n=W){R();for(let s=0;s<4;s++)S(`Player ${s+1}`,n,K[s])}function ee(n=W){R(),S("Hourglass",n,"#f59e0b")}function R(){I(),m.value=[],r.value=null}function O(n){const s=m.value.find(a=>a.id===n);!s||s.remaining<=0||(r.value&&r.value!==n&&z(r.value),s.isRunning=!0,r.value=n,c.value&&clearInterval(c.value),c.value=je(()=>{const a=m.value.find(x=>x.id===r.value);a&&a.isRunning&&(a.remaining=Math.max(0,a.remaining-1),a.remaining<=0&&(a.isRunning=!1,v()))},1e3))}function z(n){const s=m.value.find(a=>a.id===n);s&&(s.isRunning=!1),r.value===n&&(v(),r.value=null)}function te(n){const s=m.value.find(a=>a.id===n);s&&(s.isRunning?z(n):O(n))}function ne(n){const s=m.value.find(a=>a.id===n);s&&(z(n),s.remaining=s.duration)}function U(){I();for(const n of m.value)n.remaining=n.duration}function I(){v();for(const n of m.value)n.isRunning=!1;r.value=null}function v(){c.value&&(clearInterval(c.value),c.value=null)}function F(){if(m.value.length<2)return;const s=(m.value.findIndex(x=>x.id===r.value)+1)%m.value.length,a=m.value[s];r.value&&z(r.value),a.remaining>0&&O(a.id)}function A(n,s){const a=m.value.find(x=>x.id===n);a&&(a.duration=s,a.remaining=s)}function M(n){for(const s of m.value)s.duration=n,s.remaining=n}function j(n,s,a=null){const x={id:he(),name:n,duration:s,game:a};return _.value.push(x),q(),x}function L(n){const s=_.value.findIndex(a=>a.id===n);s!==-1&&(_.value.splice(s,1),q())}function N(){return JSON.stringify(_.value,null,2)}function V(n){try{const s=JSON.parse(n);if(!Array.isArray(s))return!1;for(const a of s)a.name&&typeof a.duration=="number"&&j(a.name,a.duration,a.game??null);return!0}catch{return!1}}const b=le(()=>[...De,..._.value]);function se(n){const s=Math.floor(n/60),a=n%60;return`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}function G(n){return n.duration===0?0:n.remaining/n.duration*100}const D=le(()=>m.value.some(n=>n.isRunning)),oe=le(()=>m.value.some(n=>n.remaining<=0));return X(),Ce(()=>{v()}),{timers:ie(m),activeTimerId:ie(r),presets:ie(_),allPresets:b,isAnyRunning:D,isAnyFinished:oe,createTimer:S,setupSimpleTimer:Y,setupFaceToFaceTimers:Z,setupFourPlayerTimers:Q,setupHourglass:ee,clearAllTimers:R,startTimer:O,pauseTimer:z,toggleTimer:te,resetTimer:ne,resetAll:U,stopAll:I,switchToNext:F,setDuration:A,setAllDurations:M,addPreset:j,deletePreset:L,exportPresets:N,importPresets:V,formatTime:se,getProgress:G}}const Be={class:"min-h-dvh bg-background flex flex-col"},Ee={class:"sticky top-0 z-10 bg-card/80 backdrop-blur-lg border-b border-border"},He={class:"flex items-center gap-4 px-4 py-3"},Je={class:"heading flex-1 font-display text-lg font-bold"},qe={class:"flex-1 flex flex-col"},Ze={key:0,"data-test-id":"simple-mode",class:"flex-1 flex flex-col"},Ge=["onClick"],Ke={class:"mt-4 text-muted-foreground"},We={class:"w-full max-w-md mt-8 px-8"},Xe={class:"h-2 bg-muted rounded-full overflow-hidden"},Ye={key:1,"data-test-id":"face-to-face-mode",class:"flex-1 flex flex-col"},Qe=["data-rotation","onClick"],et={class:"text-sm font-medium text-muted-foreground mb-2"},tt={class:"w-48 mt-4"},nt={class:"h-2 bg-muted rounded-full overflow-hidden"},st={key:2,"data-test-id":"four-players-mode",class:"flex-1 grid grid-cols-2 grid-rows-2"},ot=["onClick"],at={class:"text-xs font-medium text-muted-foreground mb-1"},it={class:"w-24 mt-2"},lt={class:"h-1.5 bg-muted rounded-full overflow-hidden"},rt={viewBox:"0 0 100 160",class:"w-full h-full"},ut=["y","height"],dt=["y","height"],ct={key:0,x1:"50",y1:"75",x2:"50",y2:"85",stroke:"#f59e0b","stroke-width":"2",class:"animate-pulse"},ft={class:"mt-4 text-muted-foreground text-sm"},mt={class:"sticky bottom-0 z-10 bg-card/80 backdrop-blur-lg border-t border-border p-4"},vt={class:"flex items-center justify-center gap-4"},pt={key:0,initial:{opacity:0,height:0},enter:{opacity:1,height:"auto"},"data-test-id":"presets-panel",class:"mt-4 pt-4 border-t border-border"},gt={class:"flex items-center justify-between mb-3"},ht={class:"text-sm font-medium"},_t={class:"flex gap-2"},bt={key:0,class:"flex gap-2 mb-3 p-3 bg-muted rounded-lg"},xt={class:"flex flex-wrap gap-2"},yt=["onClick"],kt={key:1,initial:{opacity:0,height:0},enter:{opacity:1,height:"auto"},"data-test-id":"settings-panel",class:"mt-4 pt-4 border-t border-border"},wt={class:"text-sm text-muted-foreground mb-3"},Tt={class:"flex flex-wrap gap-2 justify-center"},Ct=Pe({__name:"time",setup(m){const{t:r}=Se(),{timers:c,activeTimerId:_,allPresets:J,setupSimpleTimer:X,setupFaceToFaceTimers:q,setupFourPlayerTimers:S,setupHourglass:Y,toggleTimer:Z,resetAll:Q,switchToNext:ee,setAllDurations:R,addPreset:O,deletePreset:z,exportPresets:te,importPresets:ne,formatTime:U,getProgress:I}=Oe(),v=h("simple"),F=h(!1),A=h(!1),M=h(!1),j=h(5),L=h(""),N=h(5),V=h(!1),b=h(100),se=[1,2,3,5,10,15,20,30];function G(l){v.value=l;const o=j.value*60;switch(V.value=!1,l){case"simple":X(o);break;case"face-to-face":q(o);break;case"four-players":S(o);break;case"hourglass":Y(o),b.value=100;break}}function D(l){v.value==="simple"||v.value==="hourglass"?Z(l):_.value===l?ee():Z(l)}function oe(l){j.value=l,R(l*60),v.value==="hourglass"&&(b.value=100)}function n(l){const o=Math.ceil(l/60);j.value=o,R(l),v.value==="hourglass"&&(b.value=100),A.value=!1}function s(){L.value.trim()!==""&&(O(L.value.trim(),N.value*60),L.value="",N.value=5,M.value=!1)}function a(){const l=te(),o=new Blob([l],{type:"application/json"}),C=URL.createObjectURL(o),g=document.createElement("a");g.href=C,g.download="gamepal-timer-presets.json",g.click(),URL.revokeObjectURL(C)}function x(){const l=document.createElement("input");l.type="file",l.accept=".json",l.onchange=o=>{const C=o.target.files?.[0];if(!C)return;const g=new FileReader;g.onload=()=>{const y=g.result;ne(y)},g.readAsText(C)},l.click()}function _e(){if(v.value!=="hourglass")return;V.value=!V.value;const l=c.value[0];if(l){const o=l.duration-l.remaining;l.remaining=o,l.duration=o,b.value=100}}function ae(l,o,C){const g=["timer-zone","transition-all","duration-300"];return C<=0?g.push("timer-zone--finished"):o?g.push("timer-zone--active"):_.value&&_.value!==l&&g.push("timer-zone--inactive"),g.join(" ")}return Re(()=>c.value[0]?.remaining,l=>{if(v.value==="hourglass"&&c.value[0]){const o=c.value[0];b.value=o.duration>0?(l??0)/o.duration*100:0}}),Le(()=>{G("simple")}),(l,o)=>{const C=xe,g=ye,y=ke,ue=Te,de=Ie("motion");return d(),f("div",Be,[i("header",Ee,[i("div",He,[u(C,{to:"/","data-test-id":"back-btn",class:"flex h-10 w-10 items-center justify-center rounded-full text-muted-foreground hover:bg-muted hover:text-foreground transition-colors"},{default:k(()=>[u(t(Ne),{class:"h-5 w-5"})]),_:1}),i("h1",Je,p(t(r)("time.title")),1),u(g,{tabs:[{value:"simple",label:t(r)("time.modes.simple")},{value:"face-to-face",label:t(r)("time.modes.faceToFace")},{value:"four-players",label:t(r)("time.modes.fourPlayers")},{value:"hourglass",label:t(r)("time.modes.hourglass")}],"model-value":t(v),"test-id":"mode","onUpdate:modelValue":o[0]||(o[0]=e=>G(e))},null,8,["tabs","model-value"])])]),i("div",qe,[t(v)==="simple"?(d(),f("div",Ze,[(d(!0),f(B,null,E(t(c),e=>(d(),f("div",{key:e.id,"data-test-id":"timer-zone",class:T([ae(e.id,e.isRunning,e.remaining),"flex-1 flex flex-col items-center justify-center cursor-pointer select-none"]),style:P({backgroundColor:e.isRunning?e.color+"20":void 0}),onClick:w=>D(e.id)},[i("div",{class:T(["timer-display font-mono text-8xl font-bold tracking-tight",{"text-destructive animate-pulse":e.remaining<=0}]),style:P({color:e.remaining>0?e.color:void 0})},p(t(U)(e.remaining)),7),i("div",Ke,p(e.isRunning?t(r)("time.tapToPause"):t(r)("time.tapToStart")),1),i("div",We,[i("div",Xe,[i("div",{class:"h-full transition-all duration-1000",style:P({width:`${t(I)(e)}%`,backgroundColor:e.color})},null,4)])])],14,Ge))),128))])):t(v)==="face-to-face"?(d(),f("div",Ye,[(d(!0),f(B,null,E(t(c),(e,w)=>(d(),f("div",{key:e.id,"data-test-class":"timer-zone",class:T([ae(e.id,e.isRunning,e.remaining),"flex-1 flex flex-col items-center justify-center cursor-pointer select-none border-b border-border last:border-b-0"]),style:P({backgroundColor:e.isRunning?e.color+"20":void 0}),"data-rotation":w===0?"180":"0",onClick:be=>D(e.id)},[i("div",{class:T(["timer-content flex flex-col items-center",{"rotate-180":w===0}])},[i("div",et,p(e.label),1),i("div",{class:T(["timer-display font-mono text-6xl font-bold tracking-tight",{"text-destructive animate-pulse":e.remaining<=0}]),style:P({color:e.remaining>0?e.color:void 0})},p(t(U)(e.remaining)),7),i("div",tt,[i("div",nt,[i("div",{class:"h-full transition-all duration-1000",style:P({width:`${t(I)(e)}%`,backgroundColor:e.color})},null,4)])])],2)],14,Qe))),128))])):t(v)==="four-players"?(d(),f("div",st,[(d(!0),f(B,null,E(t(c),(e,w)=>(d(),f("div",{key:e.id,"data-test-class":"timer-zone",class:T([ae(e.id,e.isRunning,e.remaining),"flex flex-col items-center justify-center cursor-pointer select-none border-r border-b border-border",{"border-r-0":w%2===1,"border-b-0":w>=2}]),style:P({backgroundColor:e.isRunning?e.color+"20":void 0}),onClick:be=>D(e.id)},[i("div",{class:T(["timer-content flex flex-col items-center",{"rotate-180":w<2}])},[i("div",at,p(e.label),1),i("div",{class:T(["timer-display font-mono text-4xl font-bold tracking-tight",{"text-destructive animate-pulse":e.remaining<=0}]),style:P({color:e.remaining>0?e.color:void 0})},p(t(U)(e.remaining)),7),i("div",it,[i("div",lt,[i("div",{class:"h-full transition-all duration-1000",style:P({width:`${t(I)(e)}%`,backgroundColor:e.color})},null,4)])])],2)],14,ot))),128))])):t(v)==="hourglass"?(d(),f("div",{key:3,"data-test-id":"hourglass-mode",class:"flex-1 flex flex-col items-center justify-center cursor-pointer select-none",onClick:o[1]||(o[1]=e=>D(t(c)[0]?.id))},[i("div",{class:T(["hourglass-container relative w-48 h-80 transition-transform duration-500",{"rotate-180":t(V)}])},[(d(),f("svg",rt,[o[9]||(o[9]=ze('<defs data-v-7a14dc53><clipPath id="hourglassTop" data-v-7a14dc53><path d="M10,10 L90,10 L55,75 L45,75 Z" data-v-7a14dc53></path></clipPath><clipPath id="hourglassBottom" data-v-7a14dc53><path d="M45,85 L55,85 L90,150 L10,150 Z" data-v-7a14dc53></path></clipPath></defs><path d="M10,10 L90,10 L55,75 L55,85 L90,150 L10,150 L45,85 L45,75 Z" fill="none" stroke="currentColor" stroke-width="3" class="text-muted-foreground" data-v-7a14dc53></path>',2)),i("rect",{x:"10",y:10+65*(100-t(b))/100,width:"80",height:65*t(b)/100,fill:"#f59e0b","clip-path":"url(#hourglassTop)",class:"transition-all duration-1000"},null,8,ut),i("rect",{x:"10",y:85+65*t(b)/100,width:"80",height:65*(100-t(b))/100,fill:"#f59e0b","clip-path":"url(#hourglassBottom)",class:"transition-all duration-1000"},null,8,dt),t(c)[0]?.isRunning&&t(b)>0?(d(),f("line",ct)):$("",!0)]))],2),t(c)[0]?(d(),f("div",{key:0,class:T(["mt-6 font-mono text-4xl font-bold",{"text-destructive animate-pulse":t(c)[0].remaining<=0}])},p(t(U)(t(c)[0].remaining)),3)):$("",!0),i("div",ft,p(t(c)[0]?.isRunning?t(r)("time.tapToPause"):t(r)("time.tapToStart")),1),u(y,{variant:"outline",size:"sm",class:"mt-4","data-test-id":"flip-btn",onClick:fe(_e,["stop"])},{default:k(()=>[u(t(pe),{class:"h-4 w-4 mr-2"}),H(" "+p(t(r)("time.flip")),1)]),_:1})])):$("",!0)]),i("footer",mt,[i("div",vt,[u(y,{"data-test-id":"presets-btn",variant:"outline",size:"lg",onClick:o[2]||(o[2]=e=>{A.value=!t(A),F.value=!1})},{default:k(()=>[u(t(pe),{class:"h-5 w-5"})]),_:1}),u(y,{"data-test-id":"settings-btn",variant:"outline",size:"lg",onClick:o[3]||(o[3]=e=>{F.value=!t(F),A.value=!1})},{default:k(()=>[u(t($e),{class:"h-5 w-5"})]),_:1}),u(y,{"data-test-id":"reset-btn",variant:"outline",size:"lg",onClick:o[4]||(o[4]=e=>{t(Q)(),b.value=100})},{default:k(()=>[u(t(Fe),{class:"h-5 w-5"}),H(" "+p(t(r)("time.reset")),1)]),_:1})]),t(A)?me((d(),f("div",pt,[i("div",gt,[i("p",ht,p(t(r)("time.presets")),1),i("div",_t,[u(y,{variant:"ghost",size:"sm",onClick:x},{default:k(()=>[u(t(Ve),{class:"h-4 w-4"})]),_:1}),u(y,{variant:"ghost",size:"sm",onClick:a},{default:k(()=>[u(t(Ue),{class:"h-4 w-4"})]),_:1}),u(y,{variant:"ghost",size:"sm",onClick:o[5]||(o[5]=e=>M.value=!t(M))},{default:k(()=>[u(t(we),{class:"h-4 w-4"})]),_:1})])]),t(M)?(d(),f("div",bt,[u(ue,{modelValue:t(L),"onUpdate:modelValue":o[6]||(o[6]=e=>ve(L)?L.value=e:null),placeholder:t(r)("time.presetName"),class:"flex-1"},null,8,["modelValue","placeholder"]),u(ue,{modelValue:t(N),"onUpdate:modelValue":o[7]||(o[7]=e=>ve(N)?N.value=e:null),modelModifiers:{number:!0},type:"number",min:"1",class:"w-20",placeholder:"min"},null,8,["modelValue"]),u(y,{size:"sm",onClick:s},{default:k(()=>[H(p(t(r)("common.add")),1)]),_:1}),u(y,{variant:"ghost",size:"sm",onClick:o[8]||(o[8]=e=>M.value=!1)},{default:k(()=>[u(t(ce),{class:"h-4 w-4"})]),_:1})])):$("",!0),i("div",xt,[(d(!0),f(B,null,E(t(J),e=>(d(),Ae(y,{key:e.id,variant:"outline",size:"sm",class:"group relative","data-test-class":"preset-btn",onClick:w=>n(e.duration)},{default:k(()=>[H(p(e.name)+" ",1),e.id.startsWith("builtin")?$("",!0):(d(),f("button",{key:0,class:"absolute -top-1 -right-1 w-4 h-4 bg-destructive text-destructive-foreground rounded-full opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",onClick:fe(w=>t(z)(e.id),["stop"])},[u(t(ce),{class:"h-3 w-3"})],8,yt))]),_:2},1032,["onClick"]))),128))])])),[[de]]):$("",!0),t(F)?me((d(),f("div",kt,[i("p",wt,p(t(r)("time.duration")),1),i("div",Tt,[(d(),f(B,null,E(se,e=>u(y,{key:e,variant:t(j)===e?"default":"outline",size:"sm","data-test-class":"duration-btn",onClick:w=>oe(e)},{default:k(()=>[H(p(e)+" min ",1)]),_:2},1032,["variant","onClick"])),64))])])),[[de]]):$("",!0)])])}}}),Ut=Me(Ct,[["__scopeId","data-v-7a14dc53"]]);export{Ut as default};
