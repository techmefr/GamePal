import{_ as Se}from"./m4LV7nyU.js";import{_ as Ie}from"./Cbd6NRa-.js";import{_ as $e,X as Ne}from"./DOmmcJaj.js";import{_ as Le,P as me}from"./BXj4j506.js";import{_ as Re}from"./BGGOEJ8U.js";import{_ as Be}from"./368PfccR.js";import{_ as Me}from"./C-HMa5HP.js";import{c as ae,a as Oe}from"./W6Z6A4iW.js";import{i as ve,o,c as s,a as d,q as f,x as $,h as e,j as De,e as je,k as Ee,f as qe,b as r,w as c,t as n,F as V,s as U,G as fe,C as _e,m as O,p as P,r as p,l as Fe,y as D,d as v,z as X,_ as He}from"./_toqS5fQ.js";import{u as Ke,g as Xe}from"./7O3imeY3.js";import{u as Ye}from"./C7lDKmY2.js";import{u as Ge,P as Je}from"./BUtGkUsU.js";import{p as pe,s as Qe}from"./GJI3iByT.js";import{s as We}from"./B-6mWhxQ.js";import{A as Ze}from"./CjqhjfBM.js";import{U as et}from"./DyxQJ2ps.js";import"./DNvWDFdm.js";const tt=ae("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);const at=ae("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const lt=ae("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),ot=["aria-checked","disabled"],nt={key:0,class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"3"},st=ve({__name:"Checkbox",props:{modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(A,{emit:i}){const _=i;function Y(x){_("update:modelValue",!x)}return(x,S)=>(o(),s("button",{type:"button",role:"checkbox","aria-checked":A.modelValue,disabled:A.disabled,class:$(e(Oe)("flex h-6 w-6 shrink-0 items-center justify-center rounded-md border-2 transition-all duration-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50",A.modelValue?"border-primary bg-primary text-primary-foreground":"border-muted-foreground bg-transparent")),onClick:S[0]||(S[0]=le=>Y(A.modelValue))},[A.modelValue?(o(),s("svg",nt,[...S[1]||(S[1]=[d("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1)])])):f("",!0)],10,ot))}}),it=Object.assign(st,{__name:"UiCheckbox"}),rt={class:"min-h-dvh bg-background flex flex-col"},dt={class:"sticky top-0 z-10 bg-card/80 backdrop-blur-lg border-b border-border"},ct={class:"flex items-center gap-4 px-4 py-3"},ut={class:"heading flex-1 font-display text-lg font-bold"},mt={key:0,"data-test-id":"touch-zone",class:"touch-zone flex-1 relative"},ft={key:0,"data-test-id":"touch-hint",class:"touch-area__hint absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-muted-foreground text-lg text-center px-8"},_t={key:0,class:"touch-zone__status absolute bottom-8 left-1/2 -translate-x-1/2 text-muted-foreground animate-pulse"},pt={key:1,"data-test-id":"list-zone",class:"list-zone flex-1 p-4 flex flex-col gap-4 overflow-y-auto"},vt={class:"flex gap-2"},ht={key:0,"data-test-id":"toolbar",class:"list-zone__toolbar flex gap-2 flex-wrap"},yt={class:"font-semibold"},gt={class:"flex gap-2"},kt={key:0,class:"space-y-2"},xt={class:"flex items-center gap-2 mb-2"},bt={class:"font-medium flex-1"},Pt={key:0,class:"flex flex-wrap gap-1"},wt={key:1,class:"pt-3 border-t border-border"},Tt={class:"text-xs text-muted-foreground mb-2"},Ct={class:"flex flex-wrap gap-1"},zt={key:2,class:"player-list space-y-2"},Vt={class:"flex items-center gap-3"},Ut={class:"player-list__name flex-1 font-medium"},At={class:"player-list__actions flex gap-1"},St={key:0,class:"player-list__team-select flex flex-wrap gap-2 pt-3 mt-3 border-t border-border"},It={key:3,"data-test-id":"empty-state",class:"list-zone__empty text-center text-muted-foreground py-8"},$t={key:4,"data-test-id":"action-buttons",class:"list-zone__actions flex flex-col gap-3 mt-auto pt-4"},Nt={key:5,initial:{opacity:0,scale:.8},enter:{opacity:1,scale:1},class:"list-zone__result text-center py-8"},Lt={class:"list-zone__winner font-display text-3xl font-bold text-primary"},Rt={class:"turn-order__title font-semibold text-center mb-4"},Bt={class:"turn-order__list space-y-2"},Mt=["enter"],Ot={class:"turn-order__position w-8 h-8 flex items-center justify-center bg-primary text-primary-foreground rounded-full font-bold text-sm"},Dt={class:"turn-order__name font-medium"},jt=3e3,te=2,Et=ve({__name:"random-picker",setup(A){const{t:i}=De(),{players:_,addPlayer:Y}=Ke(),{teams:x,addTeam:S,deleteTeam:le,addPlayerToTeam:he,removePlayerFromAllTeams:ye,getPlayerTeam:I}=Ye(),G=p("touch"),N=p("player"),h=p([]),L=p(null),j=p(!1),E=p(null),{data:m}=Ge("gamepal-picker-active",[]),R=p(""),B=p(""),w=p(null),T=p([]),b=p(!1),q=p(!1),F=p(null);je(()=>{m.value.length===0&&_.value.length>0&&(m.value=_.value.map(l=>l.id))}),Ee(_,l=>{m.value=m.value.filter(a=>l.some(u=>u.id===a));for(const a of l)m.value.includes(a.id)||m.value.push(a.id)},{deep:!0});const J=X(()=>_.value.filter(l=>m.value.includes(l.id))),Q=X(()=>x.value.filter(l=>l.playerIds.filter(u=>m.value.includes(u)).length>0)),oe=X(()=>_.value.filter(l=>!I(l.id))),H=X(()=>N.value==="team"?Q.value.length>=2:J.value.length>=2);function C(l){return m.value.includes(l)}function ge(l){l.preventDefault(),se();for(const a of Array.from(l.changedTouches))h.value.push({id:a.identifier,x:a.clientX,y:a.clientY,color:Xe()});xe()}function ke(l){l.preventDefault();for(const a of Array.from(l.changedTouches)){const u=h.value.find(g=>g.id===a.identifier);u&&(u.x=a.clientX,u.y=a.clientY)}}function ne(l){l.preventDefault();for(const a of Array.from(l.changedTouches)){const u=h.value.findIndex(g=>g.id===a.identifier);u!==-1&&h.value.splice(u,1)}h.value.length<te&&W()}function xe(){W(),h.value.length>=te&&(E.value=setTimeout(()=>be(),jt))}function W(){E.value&&(clearTimeout(E.value),E.value=null)}function be(){h.value.length!==0&&(j.value=!0,L.value=pe(h.value),setTimeout(()=>{h.value=[],j.value=!1},2e3))}function se(){L.value=null,j.value=!1}function ie(){const l=R.value.trim();if(l==="")return;const a=Y(l);m.value.push(a.id),R.value=""}function Pe(l){const a=m.value.indexOf(l);a!==-1?m.value.splice(a,1):m.value.push(l)}function re(l){l?m.value=_.value.map(a=>a.id):m.value=[]}function de(){const l=B.value.trim();l!==""&&(S(l),B.value="")}function we(l){le(l)}function ce(l,a){a?he(a,l):ye(l),F.value=null}function Z(l){const a=x.value.find(u=>u.id===l);return a?_.value.filter(u=>a.playerIds.includes(u.id)):[]}function Te(){if(!H.value)return;b.value=!0,w.value=null,T.value=[];const l=N.value==="team"?Q.value.map(g=>g.name):J.value.map(g=>g.name);let a=0;const u=We(()=>{w.value=pe(l),++a>=15&&(clearInterval(u),b.value=!1)},100)}function Ce(){if(!H.value)return;b.value=!0,w.value=null,T.value=[];const l=N.value==="team"?Q.value.map(a=>a.name):J.value.map(a=>a.name);setTimeout(()=>{T.value=Qe([...l]),b.value=!1},500)}function ze(l){G.value=l,se(),w.value=null,T.value=[]}function Ve(){w.value=null,T.value=[]}return qe(()=>W()),(l,a)=>{const u=Se,g=Ie,ue=$e,k=Le,K=Re,Ue=Be,ee=Me,Ae=it,M=Fe("motion");return o(),s("div",rt,[d("header",dt,[d("div",ct,[r(u,{to:"/","data-test-id":"back-btn",class:"picker__back flex h-10 w-10 items-center justify-center rounded-full text-muted-foreground hover:bg-muted hover:text-foreground transition-colors"},{default:c(()=>[r(e(Ze),{class:"h-5 w-5"})]),_:1}),d("h1",ut,n(e(i)("randomPicker.title")),1),r(g,{tabs:[{value:"touch",label:e(i)("randomPicker.touch")},{value:"list",label:e(i)("randomPicker.list")}],"model-value":e(G),"test-id":"mode",class:"picker__mode-switch","onUpdate:modelValue":a[0]||(a[0]=t=>ze(t))},null,8,["tabs","model-value"])])]),e(G)==="touch"?(o(),s("div",mt,[d("div",{class:"touch-area absolute inset-0 touch-none select-none",onTouchstart:ge,onTouchmove:ke,onTouchend:ne,onTouchcancel:ne},[e(h).length===0?(o(),s("p",ft,n(e(i)("randomPicker.touchHint")),1)):f("",!0),(o(!0),s(V,null,U(e(h),t=>(o(),s("div",{key:t.id,class:$(["touch-point absolute w-20 h-20 rounded-full -translate-x-1/2 -translate-y-1/2 transition-all duration-300 pointer-events-none",{"scale-150 shadow-2xl z-10":e(L)?.id===t.id,"opacity-30 scale-75":e(L)&&e(L).id!==t.id}]),style:D({left:`${t.x}px`,top:`${t.y}px`,backgroundColor:t.color})},null,6))),128))],32),e(h).length>=te&&!e(j)?(o(),s("p",_t,n(e(i)("randomPicker.holdStill")),1)):f("",!0)])):(o(),s("div",pt,[r(g,{tabs:[{value:"player",label:e(i)("randomPicker.drawPlayer")},{value:"team",label:e(i)("randomPicker.drawTeam")}],"model-value":e(N),"test-id":"draw-mode",class:"list-zone__draw-modes","onUpdate:modelValue":a[1]||(a[1]=t=>{N.value=t,Ve()})},null,8,["tabs","model-value"]),d("div",vt,[r(ue,{modelValue:e(R),"onUpdate:modelValue":a[2]||(a[2]=t=>_e(R)?R.value=t:null),"data-test-id":"player-input",placeholder:e(i)("randomPicker.playerName"),class:"list-zone__input flex-1",onKeyup:fe(ie,["enter"])},null,8,["modelValue","placeholder"]),r(k,{"data-test-id":"add-player-btn",onClick:ie},{default:c(()=>[r(e(me),{class:"h-4 w-4"}),v(" "+n(e(i)("common.add")),1)]),_:1})]),e(_).length>0?(o(),s("div",ht,[r(k,{"data-test-id":"select-all-btn",variant:"outline",size:"sm",onClick:a[3]||(a[3]=t=>re(!0))},{default:c(()=>[r(e(at),{class:"h-4 w-4"}),v(" "+n(e(i)("randomPicker.selectAll")),1)]),_:1}),r(k,{"data-test-id":"deselect-all-btn",variant:"outline",size:"sm",onClick:a[4]||(a[4]=t=>re(!1))},{default:c(()=>[r(e(lt),{class:"h-4 w-4"}),v(" "+n(e(i)("randomPicker.deselectAll")),1)]),_:1}),r(k,{"data-test-id":"teams-btn",variant:"outline",size:"sm",class:$(["toolbar-btn--teams ml-auto",{"bg-primary text-primary-foreground":e(q)}]),onClick:a[5]||(a[5]=t=>q.value=!e(q))},{default:c(()=>[r(e(et),{class:"h-4 w-4"}),v(" "+n(e(i)("randomPicker.manageTeams")),1)]),_:1},8,["class"])])):f("",!0),e(q)?O((o(),P(ee,{key:1,"data-test-id":"team-manager",initial:{opacity:0,height:0},enter:{opacity:1,height:"auto"},class:"team-manager p-4 space-y-4"},{default:c(()=>[d("h3",yt,n(e(i)("randomPicker.teams")),1),d("div",gt,[r(ue,{modelValue:e(B),"onUpdate:modelValue":a[6]||(a[6]=t=>_e(B)?B.value=t:null),placeholder:e(i)("randomPicker.teamName"),class:"flex-1",onKeyup:fe(de,["enter"])},null,8,["modelValue","placeholder"]),r(k,{size:"sm",onClick:de},{default:c(()=>[r(e(me),{class:"h-4 w-4"})]),_:1})]),e(x).length>0?(o(),s("div",kt,[(o(!0),s(V,null,U(e(x),t=>(o(),s("div",{key:t.id,class:"team-item bg-muted rounded-lg p-3"},[d("div",xt,[d("span",{class:"w-3 h-3 rounded-full",style:D({backgroundColor:t.color})},null,4),d("span",bt,n(t.name),1),r(K,{variant:"secondary"},{default:c(()=>[v(n(Z(t.id).length),1)]),_:2},1024),r(Ue,{variant:"destructive",size:"sm",onClick:y=>we(t.id)},{default:c(()=>[r(e(Ne),{class:"h-4 w-4"})]),_:1},8,["onClick"])]),Z(t.id).length>0?(o(),s("div",Pt,[(o(!0),s(V,null,U(Z(t.id),y=>(o(),P(K,{key:y.id,variant:C(y.id)?"default":"secondary",class:$({"opacity-50 line-through":!C(y.id)})},{default:c(()=>[v(n(y.name),1)]),_:2},1032,["variant","class"]))),128))])):f("",!0)]))),128))])):f("",!0),e(oe).length>0?(o(),s("div",wt,[d("p",Tt,n(e(i)("randomPicker.unassigned")),1),d("div",Ct,[(o(!0),s(V,null,U(e(oe),t=>(o(),P(K,{key:t.id,variant:"outline",class:$({"opacity-50":!C(t.id)})},{default:c(()=>[v(n(t.name),1)]),_:2},1032,["class"]))),128))])])):f("",!0)]),_:1})),[[M]]):f("",!0),e(_).length>0?(o(),s("div",zt,[(o(!0),s(V,null,U(e(_),(t,y)=>O((o(),P(ee,{key:t.id,"data-test-class":"player-item","data-active":C(t.id)?"true":"false",initial:{opacity:0,x:-20},enter:{opacity:1,x:0,transition:{delay:y*30}},class:$(["player-list__item p-3",{"ring-2 ring-primary bg-primary/10":e(w)===t.name,"opacity-50":!C(t.id)}])},{default:c(()=>[d("div",Vt,[r(Ae,{"model-value":C(t.id),"data-test-class":"player-toggle","data-active":C(t.id)?"true":"false",class:"player-list__toggle","onUpdate:modelValue":z=>Pe(t.id)},null,8,["model-value","data-active","onUpdate:modelValue"]),d("span",{class:"w-6 h-6 rounded-full flex items-center justify-center text-white text-xs font-bold",style:D({backgroundColor:t.color})},n(t.name.charAt(0).toUpperCase()),5),d("span",Ut,n(t.name),1),e(I)(t.id)?(o(),P(K,{key:0,class:"player-list__team-badge",style:D({backgroundColor:e(I)(t.id)?.color})},{default:c(()=>[v(n(e(I)(t.id)?.name),1)]),_:2},1032,["style"])):f("",!0),d("div",At,[e(x).length>0?(o(),P(k,{key:0,variant:"ghost",size:"sm",class:"player-list__assign text-xs",onClick:z=>F.value=e(F)===t.id?null:t.id},{default:c(()=>[v(n(e(I)(t.id)?e(i)("randomPicker.reassign"):e(i)("randomPicker.assign")),1)]),_:2},1032,["onClick"])):f("",!0)])]),e(F)===t.id?(o(),s("div",St,[(o(!0),s(V,null,U(e(x),z=>(o(),P(k,{key:z.id,variant:"outline",size:"sm",style:D({borderColor:z.color}),onClick:qt=>ce(t.id,z.id)},{default:c(()=>[v(n(z.name),1)]),_:2},1032,["style","onClick"]))),128)),e(I)(t.id)?(o(),P(k,{key:0,variant:"ghost",size:"sm",onClick:z=>ce(t.id,null)},{default:c(()=>[v(n(e(i)("randomPicker.noTeam")),1)]),_:1},8,["onClick"])):f("",!0)])):f("",!0)]),_:2},1032,["data-active","enter","class"])),[[M]])),128))])):(o(),s("p",It,n(e(i)("randomPicker.noPlayers")),1)),e(_).length>=2?(o(),s("div",$t,[r(k,{"data-test-id":"pick-btn",disabled:e(b)||!e(H),class:"list-zone__pick-btn w-full",onClick:Te},{default:c(()=>[r(e(Je),{class:"h-4 w-4"}),v(" "+n(e(b)?e(i)("randomPicker.picking"):e(i)("randomPicker.pickRandom")),1)]),_:1},8,["disabled"]),r(k,{"data-test-id":"order-btn",variant:"outline",disabled:e(b)||!e(H),class:"list-zone__order-btn w-full",onClick:Ce},{default:c(()=>[r(e(tt),{class:"h-4 w-4"}),v(" "+n(e(i)("randomPicker.turnOrder")),1)]),_:1},8,["disabled"])])):f("",!0),e(w)&&!e(b)&&e(T).length===0?O((o(),s("div",Nt,[d("p",Lt,n(e(w)),1)])),[[M]]):f("",!0),e(T).length>0&&!e(b)?O((o(),P(ee,{key:6,initial:{opacity:0,y:20},enter:{opacity:1,y:0},class:"list-zone__turn-order p-4"},{default:c(()=>[d("h3",Rt,n(e(i)("randomPicker.turnOrderResult")),1),d("ol",Bt,[(o(!0),s(V,null,U(e(T),(t,y)=>O((o(),s("li",{key:y,initial:{opacity:0,x:-20},enter:{opacity:1,x:0,transition:{delay:y*100}},class:"turn-order__item flex items-center gap-4 p-3 bg-muted rounded-lg"},[d("span",Ot,n(y+1),1),d("span",Dt,n(t),1)],8,Mt)),[[M]])),128))])]),_:1})),[[M]]):f("",!0)]))])}}}),ia=He(Et,[["__scopeId","data-v-22924b5d"]]);export{ia as default};
